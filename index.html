
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>线粒体粘度分析系统</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css">
  <style>
    /* 表格整体样式 */
    .cell-data-table {
      table-layout: auto; /* 改为自动布局 */
    }
    .input-group-append {
      margin-left: 8px; /* 增加按钮与输入框的间距 */
    }
    /* 确保输入框和按钮之间有间距 */
    .input-group {
      display: flex;
      gap: 8px; /* 增加间距 */
      align-items: center;
    }

    @media (min-width: 992px) {
      .cell-data-table {
        table-layout: fixed; /* 大屏幕使用固定布局 */
      }
    }
    /* 表头和单元格基础样式 */
    .cell-data-table th,
    .cell-data-table td {
      padding: 12px 15px;
      text-align: left;
      border-bottom: 1px solid #e0e0e0;
      vertical-align: middle;
      box-sizing: border-box; /* 关键：包含padding在宽度内 */
    }

    /* 表头特定样式 */
    .cell-data-table th {
      background-color: #f8f9fa;
      position: sticky;
      top: 0;
      font-weight: 600;
      color: #333;
    }

    /* 精确设置每列宽度 */
    .cell-data-table thead th:nth-child(1),
    .cell-data-table tbody td:nth-child(1) {
      width: 30%;
    }

    .cell-data-table thead th:nth-child(2),
    .cell-data-table tbody td:nth-child(2) {
      width: 25%;
    }

    .cell-data-table thead th:nth-child(3),
    .cell-data-table tbody td:nth-child(3) {
      width: 25%;
    }

    .cell-data-table thead th:nth-child(4),
    .cell-data-table tbody td:nth-child(4) {
      width: 20%;
    }

    /* 输入框样式 - 确保与列宽匹配 */
    .viscosity-input {
      width: 100%;
      max-width: 100px;
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      box-sizing: border-box;
      transition: border-color 0.3s;
    }

    .viscosity-input:focus {
      border-color: #1890ff;
      outline: none;
    }
    .status-info {
      background: rgba(255, 77, 79, 0.1); /* 使用与status-danger相同的红色调 */
      color: #ff4d4f; /* 文字也改为红色 */
    }
    /* 按钮容器样式 */
    .action-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: nowrap;
    }

    /* 按钮基础样式 */
    .btn-sm {
      padding: 6px 12px;
      font-size: 12px;
      border-radius: 4px;
      cursor: pointer;
      border: 1px solid transparent;
      transition: all 0.3s;
      white-space: nowrap;
    }

    /* 不同按钮变体 */
    .btn-outline-primary {
      color: #1890ff;
      border-color: #1890ff;
      background: transparent;
    }

    .btn-outline-primary:hover {
      background: #e6f7ff;
    }

    .btn-outline-danger {
      color: #ff4d4f;
      border-color: #ff4d4f;
      background: transparent;
    }

    .btn-outline-danger:hover {
      background: #fff1f0;
    }

    /* 状态标签样式 */
    .status-cell {
      text-align: center;
    }

    .status-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
      min-width: 60px;
      text-align: center;
    }

    /* 不同状态颜色 */
    .status-empty {
      background: #f0f0f0;
      color: #999;
    }

    .status-safe {
      background: rgba(82, 196, 26, 0.1);
      color: #52c41a;
    }

    .status-warning {
      background: rgba(250, 173, 20, 0.1);
      color: #faad14;
    }

    .status-danger {
      background: rgba(255, 77, 79, 0.1);
      color: #ff4d4f;
    }

    /* 单元格图标样式 */
    .cell-icon {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      margin-right: 8px;
      font-size: 16px;
      vertical-align: middle;
    }

    /* 空状态提示 */
    .empty-message {
      color: #999;
      font-style: italic;
      padding: 12px;
    }

    /* 响应式调整 */
    @media (max-width: 768px) {
      .cell-data-table {
        font-size: 13px;
      }

      .cell-data-table th,
      .cell-data-table td {
        padding: 8px 10px;
      }

      .action-buttons {
        flex-direction: column;
        gap: 4px;
      }

      .btn-sm {
        padding: 4px 8px;
        font-size: 11px;
      }
    }

    /* 状态标签对齐 */
    .status-cell {
      text-align: center;
    }
    /* 步骤导航样式 */
    .step-nav {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
      position: relative;
    }
    .step-nav::before {
      content: '';
      position: absolute;
      top: 15px;
      left: 0;
      right: 0;
      height: 2px;
      background: #e0e0e0;
      z-index: 1;
    }
    .step-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      z-index: 2;
      padding: 0 1.5rem;
    }
    .step-circle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #e0e0e0;
      color: #999;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      margin-bottom: 0.5rem;
      transition: all 0.3s;
    }
    .step-item.active .step-circle {
      background: #1890ff;
      color: white;
    }
    .step-item.completed .step-circle {
      background: #52c41a;
      color: white;
    }
    .step-label {
      font-size: 0.9rem;
      color: #666;
      text-align: center;
    }
    .step-item.active .step-label {
      color: #1890ff;
      font-weight: 500;
    }
    .step-item.completed .step-label {
      color: #52c41a;
    }

    /* 导航页样式 */
    .welcome-page {
      text-align: center;
      padding: 2rem;
    }
    .welcome-title {
      font-size: 2.2rem;
      margin-bottom: 1.5rem;
      color: #1890ff;
    }
    .welcome-description {
      font-size: 1.1rem;
      color: #666;
      margin-bottom: 2rem;
      line-height: 1.6;
    }
    .start-options {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-top: 2rem;
      flex-wrap: wrap;
    }
    .start-card {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      width: 280px;
      cursor: pointer;
      transition: all 0.3s;
      border: 1px solid #eee;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    .start-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      border-color: #1890ff;
    }
    .start-card-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: #1890ff;
    }
    .start-card-title {
      font-size: 1.3rem;
      margin-bottom: 0.8rem;
      color: #333;
    }
    .start-card-desc {
      font-size: 0.95rem;
      color: #666;
    }

    /* 响应式设计 */
    @media (max-width: 768px) {
      .step-nav {
        flex-wrap: wrap;
      }
      .step-item {
        padding: 0 0.5rem;
        margin-bottom: 1rem;
      }
      .start-options {
        flex-direction: column;
        align-items: center;
      }
      .start-card {
        width: 100%;
      }
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      margin: 0;
      overflow-x: hidden;
    }

    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    .container {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 2rem;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    section {
      display: none;
      animation: fadeIn 0.5s ease;
    }
    section.active-step {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* 细胞选择样式 */
    .select2-container {
      width: 100% !important;
      margin-bottom: 1rem;
    }
    .selected-cells {
      margin: 1.5rem 0;
      background: #f9f9f9;
      border-radius: 8px;
      padding: 1rem;
      border: 1px dashed #ddd;
    }
    .selected-cells-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.8rem;
    }
    .cell-item {
      background: white;
      border-radius: 20px;
      padding: 0.5rem 1rem;
      display: flex;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      border: 1px solid #eee;
    }
    .cell-icon {
      margin-right: 8px;
      font-size: 1.1rem;
      display: inline-block;
      width: 20px; /* 固定图标宽度 */
      text-align: center;
    }
    .action-buttons {
      display: flex;
      justify-content: flex-start;
      flex-wrap: nowrap;
    }
    .remove-cell {
      margin-left: 8px;
      color: #ff4d4f;
      cursor: pointer;
      background: none;
      border: none;
      font-size: 1rem;
    }

    /* 数据输入样式 */
    .data-input-container {
      margin-top: 1.5rem;
    }
    .input-tabs {
      display: flex;
      margin-bottom: 1.5rem;
      border-bottom: 1px solid #ddd;
    }
    .tab-btn {
      padding: 0.6rem 1.2rem;
      background: none;
      border: none;
      cursor: pointer;
      position: relative;
      font-weight: 500;
      color: #777;
    }
    .tab-btn.active {
      color: #1890ff;
    }
    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 2px;
      background: #1890ff;
    }

    .tab-content {
      display: none;
      animation: fadeIn 0.3s ease;
    }
    .tab-content.active {
      display: block;
    }

    /* 手动输入表格 */

    .cell-data-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed; /* 使用固定布局 */
      margin: 1rem 0;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .cell-data-table th,
    .cell-data-table td {
      padding: 12px 15px; /* 统一内边距 */
      text-align: left; /* 统一文本对齐 */
      border-bottom: 1px solid #e0e0e0;
      vertical-align: middle; /* 垂直居中 */
    }

    .cell-data-table th {
      background-color: #f8f9fa;
      position: sticky;
      top: 0;
      font-weight: 500;
    }

    /* 设置列宽 - 确保表头和单元格宽度一致 */
    .cell-data-table th:nth-child(1),
    .cell-data-table td:nth-child(1) {
      width: 100%;
    }

    .cell-data-table th:nth-child(2),
    .cell-data-table td:nth-child(2) {
      width: 100%;
    }

    .cell-data-table th:nth-child(3),
    .cell-data-table td:nth-child(3) {
      width: 100%;
    }

    .cell-data-table th:nth-child(4),
    .cell-data-table td:nth-child(4) {
      width: 25%;
    }

    /* 确保输入框宽度适应 */


    .status-badge {
      padding: 0.3rem 0.6rem;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 500;
    }
    .status-empty {
      background: #f0f0f0;
      color: #999;
    }
    .status-safe {
      background: rgba(82, 196, 26, 0.1);
      color: #52c41a;
    }
    .status-warning {
      background: rgba(250, 173, 20, 0.1);
      color: #faad14;
    }
    .status-danger {
      background: rgba(255, 77, 79, 0.1);
      color: #ff4d4f;
    }

    /* Excel上传区域 */
    .upload-box {
      border: 2px dashed #ddd;
      padding: 2rem;
      text-align: center;
      border-radius: 10px;
      margin: 1rem 0;
      transition: all 0.3s;
    }
    .upload-box:hover {
      border-color: #1890ff;
    }
    .upload-box label {
      display: inline-block;
      padding: 0.6rem 1.2rem;
      background: #1890ff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      transition: background 0.3s;
      font-weight: 500;
    }
    .upload-box label:hover {
      background: #096dd9;
    }
    #excel-upload, #excel-upload-cells {
      display: none;
    }
    .file-info {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #666;
    }
    .excel-preview {
      margin-top: 1.5rem;
      border: 1px solid #eee;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    /* 结果页样式 */
    .result-container {
      margin-top: 1.5rem;
    }
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #eee;
    }
    .cell-info {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    .result-cell-icon {
      font-size: 2.2rem;
    }
    .result-cell-name {
      margin: 0;
      font-size: 1.5rem;
      color: #333;
    }
    .viscosity-summary {
      text-align: right;
    }
    .avg-viscosity {
      font-size: 1.8rem;
      font-weight: bold;
      color: #1890ff;
    }
    .risk-tag {
      display: inline-block;
      padding: 0.4rem 1rem;
      border-radius: 20px;
      font-size: 0.9rem;
      margin-top: 0.5rem;
      color: white;
      font-weight: 500;
    }

    /* 细胞选项卡样式 */
    .cell-tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }
    .cell-tab {
      padding: 0.6rem 1.2rem;
      background: #f0f0f0;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: 500;
      color: #666;
      border: 1px solid #ddd;
    }
    .cell-tab:hover {
      background: #e0e0e0;
    }
    .cell-tab.active {
      background: #1890ff;
      color: white;
      border-color: #1890ff;
    }

    /* 疾病卡片 */
    .disease-section {
      margin: 2rem 0;
    }
    .disease-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.2rem;
      margin-top: 1.5rem;
    }
    .disease-card {
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      transition: all 0.3s;
      border: 1px solid #eee;
    }
    .disease-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    .disease-img {
      height: 120px;
      background: #f5f7fa;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
      color: #1890ff;
    }
    .disease-content {
      padding: 1.2rem;
    }
    .disease-name {
      font-weight: 600;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }
    .disease-risk {
      margin: 0.8rem 0;
    }
    .risk-label {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 0.3rem;
    }
    .risk-bar {
      height: 8px;
      background: #f0f0f0;
      border-radius: 4px;
      overflow: hidden;
    }
    .risk-progress {
      height: 100%;
      background: #1890ff;
      width: 0%;
      transition: width 0.5s ease;
    }

    /* 病理机制样式 */
    .pathology-mechanism {
      margin-top: 1.5rem;
      background: #f9f9f9;
      border-radius: 8px;
      padding: 1.5rem;
    }
    .pathology-title {
      font-weight: 600;
      margin-bottom: 1rem;
      color: #333;
    }
    .pathology-content {
      white-space: pre-line;
      line-height: 1.6;
    }

    /* 建议部分 */
    .recommendations {
      background: #f9f9f9;
      border-radius: 8px;
      padding: 1.5rem;
      margin-top: 2rem;
    }
    .recommendation-list {
      margin-top: 1rem;
      padding-left: 1.2rem;
    }
    .recommendation-list li {
      margin-bottom: 0.8rem;
      line-height: 1.5;
    }

    /* 按钮样式 */
    .btn {
      padding: 0.7rem 1.4rem;
      background: #1890ff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 1rem;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .btn:hover {
      background: #096dd9;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    .btn:disabled {
      background: #d9d9d9;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .btn-restart {
      background: #ff4d4f;
      margin-top: 2rem;
      height: 80px;
    }
    .btn-restart:hover {
      background: #d9363e;
    }
    .btn-export {
      background: #722ed1;
      margin-top: 2rem;
      margin-left: 2rem;
      height: 80px;
    }
    .btn-export:hover {
      background: #531dab;
    }
    .btn-group {
      display: flex;
      justify-content: center;
      margin-top: 2rem;
      gap: 2rem;
    }

    /* 响应式设计 */
    @media (max-width: 768px) {
      .container {
        padding: 1.5rem;
        margin: 1rem auto;
      }
      .disease-cards {
        grid-template-columns: 1fr;
      }
      .result-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
      }
      .viscosity-summary {
        text-align: left;
      }
      .btn-group {
        flex-direction: column;
      }
      .btn-export {
        margin-left: 0;
        margin-top: 1rem;
      }
    }
  </style>
</head>
<body>
<!-- 动态粒子背景 -->
<div id="particles-js"></div>

<!-- 主容器 -->
<div class="container">
  <!-- 导航页 -->
  <section id="welcome-page" class="active-step">
    <div class="welcome-page">
      <h1 class="welcome-title">线粒体粘度分析系统</h1>
      <p class="welcome-description">
        本系统用于分析不同细胞类型的线粒体粘度数据，评估潜在疾病风险，并提供专业建议。<br>
        请选择您要开始的方式：
      </p>

      <div class="start-options">
        <div class="start-card" id="manual-start">
          <div class="start-card-icon">🔬</div>
          <h3 class="start-card-title">手动选择细胞</h3>
          <p class="start-card-desc">
            从列表中选择一种或多种细胞类型，然后手动输入粘度数据
          </p>
        </div>

        <div class="start-card" id="excel-start">
          <div class="start-card-icon">📊</div>
          <h3 class="start-card-title">导入Excel数据</h3>
          <p class="start-card-desc">
            直接导入包含细胞类型和粘度数据的Excel文件
          </p>
        </div>
      </div>
    </div>
  </section>
  <!-- 第1步：细胞选择 -->
  <section id="cell-selection">
    <div class="step-nav">
      <div class="step-item active">
        <div class="step-circle">1</div>
        <div class="step-label">选择细胞类型</div>
      </div>
      <div class="step-item">
        <div class="step-circle">2</div>
        <div class="step-label">输入粘度数据</div>
      </div>
      <div class="step-item">
        <div class="step-circle">3</div>
        <div class="step-label">查看分析结果</div>
      </div>
    </div>
    <h1>选择细胞类型</h1>
    <p>从下拉菜单中选择一种或多种细胞类型进行分析，或导入Excel文件</p>

    <div class="input-tabs">
      <button class="tab-btn active" data-tab="manual">
        手动选择
      </button>
      <button class="tab-btn" data-tab="excel">
        导入Excel
      </button>
    </div>

    <div class="tab-content active" id="manual-tab">
      <select id="cell-select" class="form-select" multiple="multiple">
        <!-- 动态加载细胞类型 -->
      </select>

      <div class="selected-cells">
        <h5>已选择的细胞类型：</h5>
        <div class="selected-cells-list" id="selected-cells">
          <div class="empty-message">尚未选择任何细胞类型</div>
        </div>
      </div>
    </div>

    <div class="tab-content" id="excel-tab">
      <div class="upload-box">
        <input type="file" id="excel-upload-cells" accept=".xlsx,.xls">
        <label for="excel-upload-cells">
          选择Excel文件
        </label>
        <div id="file-info-cells" class="file-info"></div>
        <div id="excel-preview-cells" class="excel-preview"></div>
      </div>
    </div>

    <div class="d-flex justify-content-end mt-3">
      <button id="next-btn" class="btn" disabled>
        下一步
      </button>
    </div>
  </section>

  <!-- 第2步：数据输入 -->
  <section id="data-input">
    <div class="step-nav">
      <div class="step-item active">
        <div class="step-circle">1</div>
        <div class="step-label">选择细胞类型</div>
      </div>
      <div class="step-item active">

        <div class="step-circle">2</div>
        <div class="step-label">输入粘度数据</div>
      </div>
      <div class="step-item">
        <div class="step-circle">3</div>
        <div class="step-label">查看分析结果</div>
      </div>
    </div>
    <h1>输入粘度数据</h1>

    <div class="input-tabs">
      <button class="tab-btn active" data-tab="manual">
        手动输入
      </button>
      <button class="tab-btn" data-tab="excel">
        导入Excel
      </button>
    </div>

    <div class="tab-content active" id="manual-tab">
      <div class="data-input-container">
        <table class="cell-data-table">
          <thead>
          <tr>
            <th >    </th>
            <th>        </th>
            <th style="text-align: right; padding-right: 187px;">  </th>
          </tr>
          </thead>
          <tbody id="manual-input-table">
          <tr>
            <td colspan="3" class="text-center py-4 text-muted">
              请先在上一步选择细胞类型
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="tab-content" id="excel-tab">
      <div class="upload-box">
        <input type="file" id="excel-upload" accept=".xlsx,.xls">
        <label for="excel-upload">
          选择Excel文件
        </label>
        <div id="file-info" class="file-info"></div>
        <div id="excel-preview" class="excel-preview"></div>
      </div>
    </div>

    <div class="d-flex justify-content-between mt-3">
      <button id="back-btn" class="btn btn-outline-secondary">
        上一步
      </button>
      <button id="analyze-btn" class="btn" disabled>
        开始分析
      </button>
    </div>
  </section>

  <!-- 第3步：分析结果 -->
  <section id="results">
    <div class="step-nav">
      <div class="step-item active">
        <div class="step-circle">1</div>
        <div class="step-label">选择细胞类型</div>
      </div>
      <div class="step-item active">
        <div class="step-circle">2</div>
        <div class="step-label">输入粘度数据</div>
      </div>
      <div class="step-item active">
        <div class="step-circle">3</div>
        <div class="step-label">查看分析结果</div>
      </div>
    </div>
    <h1>分析结果</h1>

    <div class="cell-tabs mb-4" id="cell-tabs">
      <!-- 动态生成细胞选项卡 -->
    </div>

    <div class="result-container">
      <div class="result-content" id="result-content">
        <div class="text-center py-5">
          <div style="font-size: 3rem; color: #ddd;">📊</div>
          <h4 class="mt-3 text-muted">暂无分析结果</h4>
          <p>请完成前两步操作获取分析结果</p>
        </div>
      </div>
    </div>

    <div class="btn-group">
      <button id="restart-btn" class="btn btn-restart">
        重新分析
      </button>
      <button id="export-btn" class="btn btn-export" disabled>
        导出结果
      </button>
    </div>
  </section>
</div>

<!-- 使用CDN引入必要JS库 -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<script>
  // 模拟数据库
  const cellDatabase = [

    {
      "细胞类型": "星形胶质细胞",
      "粘度变化": "升高",
      "预测疾病类型": "阿尔茨海默病（Alzheimer's Disease）",
      "病理机制": "Aβ清除障碍：星形胶质细胞通过吞噬作用清除Aβ，但线粒体功能障碍（如基质黏度增加）削弱其吞噬能力，导致Aβ沉积加重\\n谷氨酸循环异常：线粒体粘度升高阻碍谷氨酸-谷氨酰胺循环，导致突触间隙谷氨酸积累，引发兴奋性毒性\\n乳酸代谢紊乱：星形胶质细胞通过糖酵解为神经元提供乳酸，但线粒体粘度升高会抑制其自身线粒体代谢效率，导致乳酸生成异常，影响神经元的能量供应",
      "icon": "⭐"
    },
    {
      "细胞类型": "小胶质细胞",
      "粘度变化": "升高",
      "预测疾病类型": "阿尔茨海默病（Alzheimer's Disease）",
      "病理机制": "吞噬功能受损：高粘度环境下，线粒体ATP合成不足，削弱小胶质细胞清除Aβ斑块和细胞碎片的能力\\nNLRP3炎症小体激活：线粒体ROS释放增加（因粘度升高阻碍SOD活性）触发NLRP3炎症小体，导致IL-1β过度释放\\n炎症反应失控：线粒体粘度异常导致小胶质细胞代谢向糖酵解倾斜，促进促炎表型（M1型）激活，释放大量IL-1β、TNF-α等炎症因子，加剧神经炎症",
      "icon": "🔬"
    },
    {
      "细胞类型": "血管内皮细胞",
      "粘度变化": "升高",
      "预测疾病类型": "阿尔茨海默病（Alzheimer's Disease）",
      "病理机制": "血脑屏障（BBB）破坏：线粒体粘度升高导致内皮细胞能量代谢障碍，紧密连接蛋白（如ZO-1）表达下调，增加BBB通透性，使外周Aβ和炎症因子渗入脑实质\\n氧化应激加剧：内皮细胞线粒体功能障碍促进ROS释放，进一步损伤脑血管系统",
      "icon": "🩸"
    },
    {
      "细胞类型": "神经元（海马、皮层神经元）",
      "粘度变化": "升高",
      "预测疾病类型": "阿尔茨海默病（Alzheimer's Disease）",
      "病理机制": "Aβ诱导的粘度升高：Aβ寡聚体在线粒体内膜/基质中沉积，导致大分子聚集，增加基质黏度，抑制丙酮酸脱氢酶复合体（PDHC）活性，减少乙酰辅酶A生成，从而削弱能量代谢\\nTau蛋白异常磷酸化：过度磷酸化的Tau蛋白与线粒体膜结合，阻碍电子传递链复合物（如复合物I），引发氧化应激并进一步加剧基质蛋白交联，提升粘度\\n钙超载与氧化应激：线粒体Ca2+摄取失调导致钙超载，促进蛋白质聚集和脂质过氧化，形成恶性循环",
      "icon": "🧠"
    },
    {
      "细胞类型": "多巴胺能神经元（黑质致密部，SNc）",
      "粘度变化": "升高",
      "预测疾病类型": "帕金森病（Parkinson's Disease）",
      "病理机制": "α-突触核蛋白（α-syn）聚集：α-syn寡聚体嵌入线粒体内膜，改变心磷脂（cardiolipin）的分布和流动性，导致线粒体基质粘度升高，抑制复合物I（NADH脱氢酶）功能，减少ATP生成\\n氧化应激与脂质过氧化：多巴胺代谢产生的高反应性醌类物质诱导线粒体膜脂质过氧化，形成交联蛋白聚集体，显著增加基质黏度\\nPINK1/Parkin通路缺陷：自噬相关基因突变（如Parkin）导致受损线粒体清除障碍，异常线粒体累积进一步加重粘度升高",
      "icon": "❤️"
    },
    {
      "细胞类型": "小胶质细胞",
      "粘度变化": "升高",
      "预测疾病类型": "帕金森病（Parkinson's Disease）",
      "病理机制": "炎症表型激活：线粒体粘度升高导致小胶质细胞代谢向糖酵解偏移，促进促炎因子（TNF-α、IL-6）释放，激活NLRP3炎症小体，放大神经炎症\\n吞噬能力下降：高粘度环境下线粒体ATP合成不足，削弱小胶质细胞清除α-syn聚集体的能力，导致病理蛋白扩散",
      "icon": "🔬"
    },
    {
      "细胞类型": "星形胶质细胞",
      "粘度变化": "升高",
      "预测疾病类型": "帕金森病（Parkinson's Disease）",
      "病理机制": "谷氨酸-谷氨酰胺循环障碍：线粒体粘度升高抑制星形胶质细胞线粒体代谢，导致谷氨酸摄取和转化能力下降，引发突触间隙谷氨酸积累及兴奋性毒性\\n乳酸供应不足：星形胶质细胞糖酵解产生的乳酸是神经元重要能量来源，线粒体功能障碍导致乳酸生成减少，加剧神经元能量匮乏",
      "icon": "⭐"
    },
    {
      "细胞类型": "肠神经系统（ENS）神经元",
      "粘度变化": "升高",
      "预测疾病类型": "帕金森病（Parkinson's Disease）",
      "病理机制": "α-syn异常沉积：PD早期α-syn在肠道神经元线粒体中聚集，诱导粘度升高，导致线粒体自噬缺陷和局部炎症",
      "icon": "🧠"
    },
    {
      "细胞类型": "血管内皮细胞",
      "粘度变化": "升高",
      "预测疾病类型": "帕金森病（Parkinson's Disease）",
      "病理机制": "血脑屏障（BBB）渗漏：线粒体粘度升高导致内皮细胞能量代谢障碍，紧密连接蛋白（如occludin）表达下调，促进外周炎症因子和神经毒素（如百草枯）进入脑实质",
      "icon": "🩸"
    },
    {
      "细胞类型": "心肌细胞（心室肌细胞）",
      "粘度变化": "升高",
      "预测疾病类型": "心肌梗死（Myocardial Infarction）和心力衰竭（Heart Failure）",
      "病理机制": "缺血再灌注损伤：再灌注期Ca2+超载和ROS爆发诱导线粒体基质蛋白（如腺嘌呤核苷酸转运体ANT1）异常聚集，显著提高粘度，阻碍ATP向胞质扩散，加重能量危机\\n心磷脂（Cardiolipin）氧化：缺血导致线粒体内膜心磷脂氧化交联，降低膜流动性，抑制复合物V（ATP合酶）旋转效率\\nmPTP（线粒体通透性转换孔）异常开放：高粘度环境促进mPTP持续开放，引发线粒体肿胀和细胞凋亡",
      "icon": "❤️"
    },
    {
      "细胞类型": "心脏成纤维细胞",
      "粘度变化": "升高",
      "预测疾病类型": "心肌梗死（Myocardial Infarction）和心力衰竭（Heart Failure）",
      "病理机制": "代谢重编程：病理性激活的成纤维细胞线粒体粘度升高，抑制脂肪酸氧化能力，转而依赖糖酵解，促进胶原过度沉积\\nROS介导的TGF-β信号活化：高粘度导致线粒体ROS释放增加，激活TGF-β通路，驱动心肌纤维化",
      "icon": "🧶"
    },
    {
      "细胞类型": "血管内皮细胞",
      "粘度变化": "升高",
      "预测疾病类型": "心肌梗死（Myocardial Infarction）和心力衰竭（Heart Failure）",
      "病理机制": "NO合成障碍：线粒体粘度升高抑制内皮型一氧化氮合酶（eNOS）活性，减少NO生成，导致血管收缩和微循环障碍\\n炎症因子渗透：高粘度削弱内皮细胞能量代谢，破坏紧密连接，促进炎症细胞浸润（如中性粒细胞）至心肌组织",
      "icon": "🩸"
    },
    {
      "细胞类型": "免疫细胞（巨噬细胞）",
      "粘度变化": "升高",
      "预测疾病类型": "心肌梗死（Myocardial Infarction）和心力衰竭（Heart Failure）",
      "病理机制": "促炎表型极化：梗死区巨噬细胞线粒体粘度升高，促进糖酵解代谢，增强M1型极化（释放IL-1β、TNF-α），加剧心肌炎症\\n吞噬能力下降：高粘度阻碍线粒体ATP供应，削弱巨噬细胞清除坏死碎片的能力，延缓修复进程",
      "icon": "🛡️"
    },
    {
      "细胞类型": "脂肪细胞（白色脂肪细胞）",
      "粘度变化": "升高",
      "预测疾病类型": "代谢综合症和糖尿病",
      "病理机制": "脂质过载与氧化应激：肥胖状态下脂肪细胞线粒体被脂滴挤压，心磷脂（Cardiolipin）氧化导致内膜刚性增加，基质中游离脂肪酸（FFA）堆积形成胶状结构，显著升高粘度\\n线粒体生物合成抑制：PPARγ信号受损减少线粒体新生，导致老旧线粒体累积，大分子拥挤效应加剧基质黏度\\n炎症因子分泌：高粘度环境促进ROS释放，激活NF-κB通路，驱动脂肪细胞分泌TNF-α、IL-6等促炎因子",
      "icon": "🍖"
    },
    {
      "细胞类型": "骨骼肌细胞",
      "粘度变化": "升高",
      "预测疾病类型": "代谢综合症和糖尿病",
      "病理机制": "糖脂代谢紊乱：线粒体基质粘度升高抑制丙酮酸脱氢酶复合体（PDHC）活性，减少乙酰辅酶A生成，迫使细胞依赖糖酵解，乳酸堆积加重胰岛素抵抗\\n钙稳态失调：高粘度阻碍线粒体Ca2+缓冲能力，胞质Ca2+浓度异常干扰GLUT4囊泡转运，降低葡萄糖摄取\\n脂毒性：肌细胞内脂质沉积（如神经酰胺）诱导线粒体膜脂过氧化，形成蛋白交联网络，进一步增加粘度",
      "icon": "💪"
    },
    {
      "细胞类型": "肝细胞",
      "粘度变化": "升高",
      "预测疾病类型": "代谢综合症和糖尿病",
      "病理机制": "糖异生失控：线粒体粘度升高抑制苹果酸-天冬氨酸穿梭（MAS），减少NADH向线粒体转运，迫使细胞通过乳酸循环生成葡萄糖，加剧空腹高血糖\\n脂质氧化障碍：基质黏度过高阻碍脂肪酸β-氧化酶复合体的底物扩散，导致肝内甘油三酯（TG）积累（非酒精性脂肪肝，NAFLD）",
      "icon": "🍖"
    },
    {
      "细胞类型": "胰腺β细胞",
      "粘度变化": "升高",
      "预测疾病类型": "代谢综合症和糖尿病",
      "病理机制": "胰岛素分泌障碍：线粒体基质黏度升高延缓ATP扩散，减弱葡萄糖刺激的ATP/ADP比值变化，抑制KATP通道关闭和钙内流，减少胰岛素囊泡释放\\n氧化损伤：高粘度环境下SOD活性受限，ROS攻击mtDNA导致复合物IV（COX）功能缺陷，进一步削弱能量供应",
      "icon": "🧶"
    },
    {
      "细胞类型": "血管内皮细胞",
      "粘度变化": "升高",
      "预测疾病类型": "代谢综合症和糖尿病",
      "病理机制": "一氧化氮（NO）合成减少：线粒体粘度升高抑制eNOS活性，降低NO生物利用度，导致血管舒张功能障碍和高血压\\n炎症与氧化应激：高粘度促进线粒体ROS释放，激活NF-κB通路，增加血管细胞黏附分子（VCAM-1）表达，促进单核细胞浸润",
      "icon": "🩸"
    },
    {
      "细胞类型": "癌细胞（实体瘤细胞）",
      "粘度变化": "降低",
      "预测疾病类型": "某些癌症",
      "病理机制": "代谢重编程（Warburg效应）\\n部分癌细胞线粒体基质粘度显著降低（如胶质母细胞瘤），通过减少氧化磷酸化（OXPHOS）依赖，增强糖酵解效率，快速生成ATP和生物合成前体（如核苷酸、脂质）\\n代谢重编程（Warburg效应）\\n低粘度环境促进代谢物（如乳酸、α-酮戊二酸）扩散，支持肿瘤快速增殖\\n凋亡抵抗\\n线粒体膜低粘度（如内膜流动性增加）抑制细胞色素C释放，阻断凋亡信号（如Bax/Bak激活），增强化疗耐药性\\n转移潜能：低粘度线粒体通过增强钙信号（如MCU过表达）激活EMT（上皮-间质转化）通路，促进细胞迁移和侵袭",
      "icon": "🦠"
    },
    {
      "细胞类型": "肿瘤相关成纤维细胞（CAFs）",
      "粘度变化": "升高",
      "预测疾病类型": "某些癌症",
      "病理机制": "nan",
      "icon": "🧶"
    },
    {
      "细胞类型": "肿瘤浸润性T细胞",
      "粘度变化": "升高",
      "预测疾病类型": "某些癌症",
      "病理机制": "免疫耗竭\\nT细胞线粒体基质粘度升高（因慢性抗原刺激诱导氧化损伤），抑制OXPHOS和ATP生成，导致效应功能丧失\\n免疫耗竭\\n高粘度阻碍线粒体动态（融合/分裂），减少记忆T细胞分化能力",
      "icon": "🛡️"
    },
    {
      "细胞类型": "肿瘤相关巨噬细胞（TAMs）",
      "粘度变化": "升高",
      "预测疾病类型": "某些癌症",
      "病理机制": "促肿瘤表型极化\\nTAMs线粒体粘度升高（因脂质过载和ROS积累），驱动糖酵解依赖，促进M2型极化（分泌IL-10、TGF-β），抑制抗肿瘤免疫\\n促肿瘤表型极化\\n高粘度抑制线粒体自噬，导致受损线粒体累积，激活NLRP3炎症小体，加剧局部炎症",
      "icon": "🛡️"
    },
    {
      "细胞类型": "肿瘤血管内皮细胞",
      "粘度变化": "降低",
      "预测疾病类型": "某些癌症",
      "病理机制": "异常血管生成\\n内皮细胞线粒体粘度降低（因VEGF信号过度激活），增强代谢灵活性，支持快速增殖和血管新生",
      "icon": "🩸"
    },
    {
      "细胞类型": "骨骼肌细胞",
      "粘度变化": "升高",
      "预测疾病类型": "线粒体肌病（Mitochondrial Myopathies）",
      "病理机制": "mtDNA突变与酶复合体缺陷：线粒体DNA（mtDNA）突变（如m.3243A>G）或核DNA突变（如POLG）导致呼吸链复合物（如复合物I、IV）组装异常，未组装的蛋白亚基在线粒体基质中堆积，形成大分子聚集体，显著增加基质黏度\\n嵴结构紊乱：心磷脂（cardiolipin）合成缺陷（如Barth综合征相关基因TAZ突变）导致线粒体内膜嵴结构破坏，形成囊泡状或同心圆排列，阻碍质子梯度形成并加剧底物扩散阻力\\n氧化应激与蛋白交联：ROS过度生成诱导基质蛋白（如腺嘌呤核苷酸转运体ANT1）发生羰基化交联，形成不可逆聚集物，进一步升高粘度",
      "icon": "💪"
    },
    {
      "细胞类型": "肌肉卫星细胞（干细胞）",
      "粘度变化": "升高",
      "预测疾病类型": "线粒体肌病（Mitochondrial Myopathies）",
      "病理机制": "再生能力受损：卫星细胞线粒体基质黏度过高（因ROS积累和代谢物扩散受阻），抑制其增殖分化能力，导致肌肉修复障碍\\n代谢重编程：高粘度迫使卫星细胞依赖糖酵解供能，减少成肌分化关键因子（如MyoD）的表达",
      "icon": "💪"
    },
    {
      "细胞类型": "血管内皮细胞（肌肉微血管）",
      "粘度变化": "升高",
      "预测疾病类型": "线粒体肌病（Mitochondrial Myopathies）",
      "病理机制": "能量供应不足：内皮细胞线粒体粘度升高导致ATP合成减少，血管舒张功能受损（NO生成减少），加剧肌肉缺血缺氧\\n炎症浸润：高粘度环境促进内皮细胞释放IL-6、MCP-1，招募炎症细胞浸润肌肉组织，加重氧化损伤",
      "icon": "🩸"
    },
    {
      "细胞类型": "周围神经元（部分亚型）",
      "粘度变化": "升高",
      "预测疾病类型": "线粒体肌病（Mitochondrial Myopathies）",
      "病理机制": "兴奋-收缩耦联受损：Ca2+缓冲能力下降（因基质黏度高）干扰动作电位传导，削弱肌肉收缩协调性",
      "icon": "🧠"
    },
    {
      "细胞类型": "视网膜神经节细胞（Retinal Ganglion Cells, RGCs）",
      "粘度变化": "升高",
      "预测疾病类型": "未知",
      "病理机制": "氧化应激与蛋白聚集：电子漏增加导致超氧化物（O2-）爆发，诱导线粒体基质蛋白（如NDUFS1）发生羰基化交联，形成大分子聚集体，显著升高基质黏度\\n钙稳态失衡：粘度升高阻碍Ca2+缓冲能力，胞质钙超载触发兴奋性毒性，加速RGCs凋亡",
      "icon": "👁️"
    },
    {
      "细胞类型": "星形胶质细胞（视神经乳头区域）",
      "粘度变化": "升高",
      "预测疾病类型": "未知",
      "病理机制": "谷氨酸清除障碍：星形胶质细胞线粒体粘度升高抑制谷氨酸转运体（GLT-1）活性，导致突触间隙谷氨酸积累，引发RGCs兴奋性毒性\\n乳酸代谢异常：高粘度环境下糖酵解增强，乳酸过度释放至RGCs微环境，干扰线粒体氧化磷酸化",
      "icon": "⭐"
    },
    {
      "细胞类型": "轴突线粒体（视神经纤维）",
      "粘度变化": "升高",
      "预测疾病类型": "未知",
      "病理机制": "线粒体运输停滞：轴突内线粒体因高粘度无法沿微管有效运输，导致远端轴突（如视交叉）能量耗竭，引发华勒变性（Wallerian degeneration）\\n自噬缺陷：Parkin蛋白无法募集至受损线粒体（因黏度过高阻碍泛素化信号），导致异常线粒体累积",
      "icon": "🧠"
    },
    {
      "细胞类型": "血管内皮细胞（视网膜微血管）",
      "粘度变化": "升高",
      "预测疾病类型": "未知",
      "病理机制": "血-视网膜屏障（BRB）损伤：内皮细胞线粒体粘度升高导致ATP合成不足，紧密连接蛋白（如ZO-1）表达下调，血管渗漏加剧氧化应激物质（如铁离子）侵入RGCs",
      "icon": "🩸"
    },
    {
      "细胞类型": "肝细胞",
      "粘度变化": "升高",
      "预测疾病类型": "肝脏疾病（如脂肪肝和肝炎）",
      "病理机制": "脂毒性诱导\\n脂肪肝（NAFLD/NASH）：游离脂肪酸（FFA）过载导致线粒体基质中脂滴积聚，心磷脂（cardiolipin）氧化交联形成刚性结构，显著增加基质黏度，抑制β-氧化酶复合体（如CPT1）的底物扩散，加剧脂质沉积\\n脂毒性诱导\\n肝炎（酒精性/病毒性）：乙醇代谢产物（乙醛）或病毒蛋白（如HCV核心蛋白）诱导线粒体膜脂质过氧化，促进蛋白质羰基化交联，形成凝胶态基质\\n氧化应激与能量危机：高粘度环境阻碍电子传递链（ETC）复合物（如复合物I、III）的质子泵效率，增加电子漏和ROS生成，进一步损伤线粒体DNA（mtDNA）",
      "icon": "🍖"
    },
    {
      "细胞类型": "肝星状细胞（HSCs）",
      "粘度变化": "升高",
      "预测疾病类型": "肝脏疾病（如脂肪肝和肝炎）",
      "病理机制": "活化与纤维化驱动\\n慢性炎症环境下，HSCs线粒体粘度升高（因ROS诱导的蛋白交联），抑制脂肪酸氧化能力，转而依赖糖酵解供能，促进其活化并分泌胶原（如Collagen I）\\n活化与纤维化驱动\\n高粘度阻碍线粒体自噬，导致受损线粒体累积，激活TGF-β信号通路，加剧纤维化进程",
      "icon": "🧶"
    },
    {
      "细胞类型": "Kupffer细胞（肝脏巨噬细胞）",
      "粘度变化": "升高",
      "预测疾病类型": "肝脏疾病（如脂肪肝和肝炎）",
      "病理机制": "促炎表型极化\\n脂毒性或病原体相关分子模式（PAMPs）刺激下，Kupffer细胞线粒体粘度升高，抑制OXPHOS能力，转向糖酵解代谢，驱动M1型极化（分泌TNF-α、IL-1β），放大肝脏炎症\\n促炎表型极化\\n高粘度阻碍线粒体ROS清除（如SOD活性受限），激活NLRP3炎症小体，导致IL-18过度释放",
      "icon": "🛡️"
    },
    {
      "细胞类型": "肝窦内皮细胞（LSECs）",
      "粘度变化": "升高",
      "预测疾病类型": "肝脏疾病（如脂肪肝和肝炎）",
      "病理机制": "微循环障碍\\n线粒体粘度升高导致LSECs能量代谢紊乱，NO合成减少，引发肝窦收缩和门静脉高压\\n微循环障碍\\n高粘度促进内皮细胞黏附分子（如ICAM-1）表达，招募中性粒细胞浸润，加重肝损伤",
      "icon": "🩸"
    },
    {
      "细胞类型": "T淋巴细胞（CD4+辅助T细胞）",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "代谢失衡与炎症极化\\n线粒体基质黏度升高抑制氧化磷酸化（OXPHOS），迫使T细胞依赖糖酵解供能，促进促炎亚群（如Th17）分化，同时抑制调节性T细胞（Treg）功能\\n代谢失衡与炎症极化\\n高粘度阻碍NADH/NAD+穿梭，导致乙酰辅酶A生成减少，影响表观遗传修饰（如组蛋白乙酰化），驱动自身反应性T细胞克隆扩增\\n线粒体ROS信号异常：粘度升高导致电子传递链（ETC）电子漏增加，ROS（如O2-、H2O2）过度释放，激活NF-κB和mTOR通路，增强IFN-γ、IL-17等促炎因子分泌",
      "icon": "🛡️"
    },
    {
      "细胞类型": "B淋巴细胞",
      "粘度变化": "降低",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "抗体生成亢进\\n线粒体基质低粘度（部分亚型）促进糖酵解代谢，提供快速能量支持浆细胞分化和自身抗体（如抗dsDNA抗体）大量分泌",
      "icon": "🛡️"
    },
    {
      "细胞类型": "B淋巴细胞",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "抗体生成亢进，高粘度区域（如线粒体嵴间腔）抑制抗凋亡蛋白（如Mcl-1）扩散，导致自身反应性B细胞异常存活",
      "icon": "🛡️"
    },
    {
      "细胞类型": "B淋巴细胞",
      "粘度变化": "异常",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "抗原呈递异常：线粒体黏度变化干扰B细胞受体（BCR）信号传导，增强对核小体等自身抗原的提呈能力",
      "icon": "🛡️"
    },




    {
      "细胞类型": "树突状细胞（DCs）",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "过度活化与免疫耐受打破\\n线粒体黏度升高抑制OXPHOS，迫使DCs依赖糖酵解，促进成熟和促炎细胞因子（如IL-6、TNF-α）分泌，增强对自身抗原的提呈效率\\n过度活化与免疫耐受打破\\n高粘度阻碍线粒体自噬，导致损伤相关分子模式（DAMPs，如mtDNA）释放至胞质，激活cGAS-STING通路，驱动I型干扰素（IFN-α/β）风暴",
      "icon": "🛡️"
    },
    {
      "细胞类型": "中性粒细胞",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "NETosis异常增强\\n线粒体黏度升高导致ROS爆发，激活NADPH氧化酶（NOX2），促进中性粒细胞胞外陷阱（NETs）形成，释放自身抗原（如LL-37、HMGB1），加剧免疫复合物沉积\\nNETosis异常增强\\n高粘度抑制线粒体钙缓冲能力，触发钙依赖性蛋白酶（如钙蛋白酶）激活，加速NETs释放",
      "icon": "🛡️"
    },
    {
      "细胞类型": "血管内皮细胞",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "血管炎与血栓形成\\n线粒体黏度升高抑制eNOS活性，减少NO生成，导致血管收缩和血小板活化，促进微血栓形成（如抗磷脂综合征）\\n血管炎与血栓形成\\n高粘度环境增强内皮细胞黏附分子（VCAM-1、ICAM-1）表达，促进白细胞浸润至靶器官（如肾脏、皮肤）",
      "icon": "🩸"
    },
    {
      "细胞类型": "神经元（轴突和胞体）",
      "粘度变化": "升高",
      "预测疾病类型": "多发性硬化症（Multiple Sclerosis, MS）",
      "病理机制": "能量供应崩溃\\n脱髓鞘导致轴突离子通道（如Na+/K+泵）代偿性高表达，ATP需求激增，线粒体因持续负荷出现基质黏度升高（因ROS诱导的蛋白交联），阻碍ATP扩散至离子通道区域\\n能量供应崩溃\\n高粘度抑制线粒体沿轴突微管的运输效率，远端轴突能量耗竭引发退行性变（如轴突横断）\\n钙稳态失衡：基质黏度升高削弱线粒体Ca2+缓冲能力，胞质钙超载激活钙依赖性蛋白酶（如钙蛋白酶），破坏神经元骨架结构",
      "icon": "🧠"
    },
    {
      "细胞类型": "少突胶质细胞",
      "粘度变化": "升高",
      "预测疾病类型": "多发性硬化症（Multiple Sclerosis, MS）",
      "病理机制": "髓鞘再生障碍\\n线粒体基质黏度升高（因mtDNA突变或氧化损伤）抑制脂肪酸合成酶活性，阻碍胆固醇和脂质生成，限制髓鞘修复能力\\n髓鞘再生障碍\\n高粘度阻碍丙酮酸脱氢酶复合体（PDHC）功能，减少乙酰辅酶A供应，影响少突胶质前体细胞（OPCs）分化",
      "icon": "⚪"
    },
    {
      "细胞类型": "小胶质细胞/巨噬细胞",
      "粘度变化": "升高",
      "预测疾病类型": "多发性硬化症（Multiple Sclerosis, MS）",
      "病理机制": "促炎表型极化\\n线粒体黏度升高抑制OXPHOS，迫使细胞依赖糖酵解，驱动M1型极化（释放IL-1β、TNF-α），放大神经炎症和脱髓鞘\\n促炎表型极化\\n高粘度阻碍线粒体自噬，导致受损线粒体累积并释放mtDNA，激活cGAS-STING通路，触发I型干扰素（IFN-β）风暴",
      "icon": "🛡️"
    },
    {
      "细胞类型": "T淋巴细胞（自身反应性CD4⁺ T细胞）",
      "粘度变化": "降低",
      "预测疾病类型": "多发性硬化症（Multiple Sclerosis, MS）",
      "病理机制": "代谢重编程与炎症扩增\\n线粒体低粘度（部分亚型）促进糖酵解代谢，支持Th1/Th17细胞增殖和穿越血脑屏障（BBB），攻击髓鞘蛋白（如MBP）",
      "icon": "🛡️"
    },
    {
      "细胞类型": "T淋巴细胞（自身反应性CD4⁺ T细胞）",
      "粘度变化": "升高",
      "预测疾病类型": "多发性硬化症（Multiple Sclerosis, MS）",
      "病理机制": "代谢重编程与炎症扩增\\n高粘度区域抑制Treg细胞功能，打破免疫耐受，加剧自身免疫攻击",
      "icon": "🛡️"
    },
    {
      "细胞类型": "星形胶质细胞",
      "粘度变化": "升高",
      "预测疾病类型": "多发性硬化症（Multiple Sclerosis, MS）",
      "病理机制": "瘢痕形成与毒性微环境\\n活化星形胶质细胞线粒体黏度升高（因谷氨酸兴奋性毒性），抑制谷氨酸摄取，导致突触间隙谷氨酸堆积，引发神经元损伤\\n瘢痕形成与毒性微环境\\n高粘度促进ROS释放，激活NF-κB通路，分泌促纤维化因子（如TGF-β），形成胶质瘢痕阻碍轴突再生",
      "icon": "⭐"
    },
    {
      "细胞类型": "树突状细胞（DCs）",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "过度活化与免疫耐受打破\n线粒体黏度升高抑制OXPHOS，迫使DCs依赖糖酵解，促进成熟和促炎细胞因子（如IL-6、TNF-α）分泌，增强对自身抗原的提呈效率\n过度活化与免疫耐受打破\n高粘度阻碍线粒体自噬，导致损伤相关分子模式（DAMPs，如mtDNA）释放至胞质，激活cGAS-STING通路，驱动I型干扰素（IFN-α/β）风暴",
      "icon": "🛡️"
    },
    {
      "细胞类型": "中性粒细胞",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "NETosis异常增强\n线粒体黏度升高导致ROS爆发，激活NADPH氧化酶（NOX2），促进中性粒细胞胞外陷阱（NETs）形成，释放自身抗原（如LL-37、HMGB1），加剧免疫复合物沉积\nNETosis异常增强\n高粘度抑制线粒体钙缓冲能力，触发钙依赖性蛋白酶（如钙蛋白酶）激活，加速NETs释放",
      "icon": "🛡️"
    },
    {
      "细胞类型": "T细胞",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如类风湿关节炎RA）",
      "病理机制": "Th1/Th17极化失衡\n线粒体高粘度通过HIF-1α稳定化促进糖酵解代谢重编程，驱动初始CD4+T细胞向促炎性Th1/Th17亚群分化，同时抑制调节性T细胞（Treg）功能\nTh1/Th17极化失衡\n黏度升高导致线粒体膜电位去极化，增加mtROS产生，激活NF-κB和STAT3信号通路，促进IL-17和IFN-γ分泌",
      "icon": "🔬"
    },
    {
      "细胞类型": "B细胞",
      "粘度变化": "升高",
      "预测疾病类型": "自体免疫性疾病（如系统性红斑狼疮SLE）",
      "病理机制": "自身抗体异常产生\n高粘度诱导的线粒体功能障碍促进B细胞代谢转向糖酵解，增强B细胞活化因子（BAFF）敏感性，导致自身反应性B细胞克隆逃逸中枢耐受\n自身抗体异常产生\n粘度升高损害线粒体Ca2+缓冲能力，激活NFAT信号通路，驱动自身抗体（如抗dsDNA、抗Smith抗体）过度分泌",
      "icon": "🦠"
    },
    {
      "细胞类型": "巨噬细胞",
      "粘度变化": "升高",
      "预测疾病类型": "炎症性疾病（如动脉粥样硬化）",
      "病理机制": "促炎M1极化\n线粒体黏度升高通过抑制OXPHOS促进糖酵解依赖的代谢重编程，驱动巨噬细胞向促炎M1表型极化，增加IL-1β、TNF-α和iNOS表达\n促炎M1极化\n高粘度导致线粒体DNA（mtDNA）泄漏至胞质，激活NLRP3炎症小体，促进caspase-1依赖的IL-1β成熟与分泌",
      "icon": "🧫"
    },
    {
      "细胞类型": "肝细胞",
      "粘度变化": "升高",
      "预测疾病类型": "代谢性疾病（如非酒精性脂肪肝NAFLD）",
      "病理机制": "脂质代谢紊乱\n线粒体高粘度损害β-氧化效率，导致游离脂肪酸（FFA）在胞质内积累，形成脂滴并诱发肝细胞脂肪变性\n脂质代谢紊乱\n粘度升高抑制电子传递链（ETC）复合物活性，增加ROS产生，诱发内质网应激和JNK通路激活，促进胰岛素抵抗",
      "icon": "🍖"
    },
    {
      "细胞类型": "心肌细胞",
      "粘度变化": "升高",
      "预测疾病类型": "心血管疾病（如心力衰竭）",
      "病理机制": "收缩功能障碍\n高粘度增加线粒体内膜刚性，损害ATP合成效率，导致心肌细胞能量供应不足，影响肌丝滑行和钙循环\n收缩功能障碍\n粘度升高诱导线粒体通透性转换孔（mPTP）异常开放，促进细胞色素C释放，激活caspase依赖性凋亡通路",
      "icon": "❤️"
    },
    {
      "细胞类型": "神经元",
      "粘度变化": "升高",
      "预测疾病类型": "神经退行性疾病（如阿尔茨海默病AD）",
      "病理机制": "突触功能障碍\n线粒体高粘度损害轴突运输效率，导致突触前末端能量供应不足，影响神经递质释放和突触可塑性\n突触功能障碍\n粘度升高促进Aβ寡聚体在线粒体内积累，抑制复合物IV活性，增加氧化损伤并诱发tau蛋白过度磷酸化",
      "icon": "🧠"
    },
    {
      "细胞类型": "内皮细胞",
      "粘度变化": "升高",
      "预测疾病类型": "血管功能障碍（如高血压）",
      "病理机制": "一氧化氮（NO）生物利用度降低\n高粘度增加线粒体ROS产生，加速NO被超氧阴离子（O2-）猝灭，导致血管舒张功能受损\n一氧化氮（NO）生物利用度降低\n粘度升高损害eNOS活性，减少NO合成，同时促进内皮素-1（ET-1）分泌，加剧血管收缩",
      "icon": "🩸"
    },
    {
      "细胞类型": "β细胞",
      "粘度变化": "升高",
      "预测疾病类型": "代谢性疾病（如2型糖尿病T2DM）",
      "病理机制": "胰岛素分泌缺陷\n线粒体高粘度损害葡萄糖刺激的ATP合成，减弱KATP通道关闭和钙内流，导致葡萄糖依赖性胰岛素分泌（GSIS）受损\n胰岛素分泌缺陷\n粘度升高诱导线粒体分裂-融合失衡，促进DRP1依赖性线粒体碎片化，加剧β细胞去分化",
      "icon": "🩺"
    }]
  // 初始化粒子背景
  document.addEventListener('DOMContentLoaded', () => {
    particlesJS('particles-js', {
      particles: {
        number: { value: 80, density: { enable: true, value_area: 800 } },
        color: { value: "#1890ff" },
        shape: { type: "circle" },
        opacity: { value: 0.5, random: true },
        size: { value: 3, random: true },
        line_linked: { enable: true, distance: 150, color: "#1890ff", opacity: 0.4, width: 1 },
        move: { enable: true, speed: 2, direction: "none", random: true }
      },
      interactivity: {
        detect_on: "canvas",
        events: {
          onhover: { enable: true, mode: "repulse" },
          onclick: { enable: true, mode: "push" }
        }
      }
    });

    // 初始化细胞选择下拉框
    function initCellSelect() {
      const cellOptions = cellDatabase.map(cell => ({
        id: cell.细胞类型,
        text: cell.细胞类型,
        icon: cell.icon
      }));

      $('#cell-select').empty();
      cellOptions.forEach(cell => {
        $('#cell-select').append(
                $('<option></option>')
                        .attr('value', cell.id)
                        .text(cell.text)
                        .data('icon', cell.icon)
        );
      });

      $('#cell-select').select2({
        placeholder: "选择细胞类型...",
        allowClear: true,
        templateResult: formatCellOption,
        templateSelection: formatCellSelection,
        width: '100%'
      });
    }

    // 格式化下拉选项
    function formatCellOption(cell) {
      if (!cell.id) return cell.text;
      const $option = $(
              `<span><span class="cell-icon">${$(cell.element).data('icon')}</span> ${cell.text}</span>`
      );
      return $option;
    }

    // 格式化选中的选项
    function formatCellSelection(cell) {
      if (!cell.id) return cell.text;
      return cell.text;
    }

    // 初始化应用
    initCellSelect();

    // 存储选中的细胞和数据
    let selectedCells = [];
    let cellData = {};

    // 细胞选择变化事件
    $('#cell-select').on('change', function() {
      selectedCells = Array.from($(this).find('option:selected')).map(opt => ({
        id: opt.value,
        name: opt.text,
        icon: $(opt).data('icon')
      }));

      updateSelectedCellsList();
      $('#next-btn').prop('disabled', selectedCells.length === 0);
    });

    // 更新已选细胞列表
    function updateSelectedCellsList() {
      const container = $('#selected-cells');
      container.empty();

      if (selectedCells.length === 0) {
        container.append('<div class="empty-message">尚未选择任何细胞类型</div>');
        return;
      }

      selectedCells.forEach(cell => {
        const item = $(`
            <div class="cell-item" data-cell="${cell.id}">
              <span class="cell-icon">${cell.icon}</span>
              <span>${cell.name}</span>
              <button class="remove-cell" data-cell="${cell.id}">
                ×
              </button>
            </div>
          `);
        container.append(item);
      });

      // 添加移除按钮事件
      $('.remove-cell').on('click', function() {
        const cellId = $(this).data('cell');
        $('#cell-select option[value="' + cellId + '"]').prop('selected', false);
        $('#cell-select').trigger('change');
      });
    }

    // 标签切换
    $('.tab-btn').on('click', function() {
      const tabId = $(this).data('tab');

      // 如果是细胞选择页面的标签切换
      if ($(this).closest('#cell-selection').length) {
        $('.tab-btn', '#cell-selection').removeClass('active');
        $(this).addClass('active');

        $('.tab-content', '#cell-selection').removeClass('active');
        $(`#${tabId}-tab`, '#cell-selection').addClass('active');

        // 重置下一步按钮状态
        if (tabId === 'manual') {
          $('#next-btn').prop('disabled', selectedCells.length === 0);
        } else {
          $('#next-btn').prop('disabled', $('#file-info-cells').text() === '');
        }
      }
      // 如果是数据输入页面的标签切换
      else {
        $('.tab-btn', '#data-input').removeClass('active');
        $(this).addClass('active');

        $('.tab-content', '#data-input').removeClass('active');
        $(`#${tabId}-tab`, '#data-input').addClass('active');

        if (tabId === 'manual') {
          generateManualInputTable();
        } else {
          $('#excel-preview').empty();
        }

        checkAllInputsComplete();
      }
    });

    // 下一步按钮
    // 修改下一步按钮的点击事件处理
    $('#next-btn').on('click', function() {
      // 如果当前是Excel导入模式
      if ($('#excel-tab', '#cell-selection').hasClass('active')) {
        const file = $('#excel-upload-cells')[0].files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, { type: 'array' });
          const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
          const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

          // 处理Excel数据
          processExcelDataForCellSelection(jsonData);

          // 切换到数据输入页面
          $('#cell-selection').removeClass('active-step');
          $('#data-input').addClass('active-step');

          // 自动切换到手动输入标签（因为数据已导入）
          $('.tab-btn', '#data-input').removeClass('active');
          $('.tab-btn[data-tab="manual"]', '#data-input').addClass('active');

          $('.tab-content', '#data-input').removeClass('active');
          $('#manual-tab', '#data-input').addClass('active');

          // 这里不再调用generateManualInputTable()，因为processExcelDataForCellSelection中已经处理
        };
        reader.readAsArrayBuffer(file);
      }
      // 如果是手动选择模式
      else {
        $('#cell-selection').removeClass('active-step');
        $('#data-input').addClass('active-step');

        // 根据选择的细胞生成输入表格
        if ($('#manual-tab', '#data-input').hasClass('active')) {
          generateManualInputTable();
        }
      }
    });
    // 处理细胞选择Excel数据
// 在processExcelDataForCellSelection函数中添加以下内容
// 修改processExcelDataForCellSelection函数
    function processExcelDataForCellSelection(data) {
      selectedCells = [];
      const rawExcelData = {}; // 临时存储原始Excel数据

      // 标记数据来源
      window.dataSource = 'excel';

      for (let i = 1; i < data.length; i++) {
        const row = data[i];
        if (!row || row.length < 2) continue;

        const cellType = row[0];
        if (!cellType) continue;

        const matchedCell = cellDatabase.find(c => c.细胞类型 === cellType);
        if (!matchedCell) continue;

        // 收集所有粘度值
        const viscosities = [];
        for (let j = 1; j < row.length; j++) {
          const value = parseFloat(row[j]);
          if (!isNaN(value) && value > 0 && value <= 200) {
            viscosities.push(value);
          }
        }

        if (viscosities.length > 0) {
          // 存储原始数据（临时）
          if (!rawExcelData[cellType]) {
            rawExcelData[cellType] = {
              name: matchedCell.细胞类型,
              icon: matchedCell.icon,
              rawData: []
            };
          }
          rawExcelData[cellType].rawData.push(...viscosities);

          // 添加到选中的细胞列表
          if (!selectedCells.some(c => c.id === matchedCell.细胞类型)) {
            selectedCells.push({
              id: matchedCell.细胞类型,
              name: matchedCell.细胞类型,
              icon: matchedCell.icon,
              source: 'excel'
            });
          }
        }
      }

      // 计算平均值并存入cellData
      cellData = {};
      Object.keys(rawExcelData).forEach(cellType => {
        const cell = rawExcelData[cellType];
        const sum = cell.rawData.reduce((a, b) => a + b, 0);
        const avg = sum / cell.rawData.length;

        cellData[cellType] = {
          name: cell.name,
          icon: cell.icon,
          data: [avg], // 只存储平均值
          rawData: cell.rawData, // 保留原始数据用于详情查看
          source: 'excel'
        };
      });

      // 更新UI
      updateSelectedCellsList();
      generateEditableInputTableFromExcelData();

      // 直接启用分析按钮
      $('#analyze-btn').prop('disabled', false);
    }

// 新增函数：从Excel数据生成可编辑表格

// 修改后的 processExcelDataForCellSelection 函数

// 统一的数据处理函数
// 统一的数据处理函数
// 修改后的processInputData函数
    function processInputData() {
      const processedData = {};
      let hasValidData = false;

      // 处理手动输入数据
      $('#manual-input-body tr[data-cell]').each(function() {
        const cellId = $(this).data('cell');
        const inputValue = $(this).find('.viscosity-input').val();
        const value = parseFloat(inputValue);

        if (!isNaN(value)) {
          if (!processedData[cellId]) {
            const cellInfo = selectedCells.find(c => c.id === cellId);
            if (cellInfo) {
              processedData[cellId] = {
                name: cellInfo.name,
                icon: cellInfo.icon,
                data: []
              };
            }
          }
          processedData[cellId].data.push(value);
          hasValidData = true;
        }
      });

      // 检查是否所有选中的细胞都有数据
      const allCellsHaveData = selectedCells.every(cell =>
              processedData[cell.id] && processedData[cell.id].data.length > 0
      );

      return {
        data: processedData,
        isValid: hasValidData && allCellsHaveData
      };
    }

// 修改后的分析按钮点击事件

// 修改后的 analyze-btn 点击事件
    $('#analyze-btn').on('click', function() {

      // 检查是否有有效数据
      if (Object.keys(cellData).length === 1) {
        alert('没有有效数据可供分析');
        return;
      }

      // 确保所有数据都是平均值形式
      Object.keys(cellData).forEach(cellId => {
        const cell = cellData[cellId];
        if (cell.data.length > 1) { // 如果有多条数据，重新计算平均值
          const sum = cell.data.reduce((a, b) => a + b, 0);
          cell.data = [sum / cell.data.length];
        }
      });

      // 显示结果
      showResults();
      $('#export-btn').prop('disabled', false);
    });


// 修改后的 analyze-btn
// 新增：生成可编辑的输入表格
// 在generateEditableInputTableFromExcelData函数中添加：
    function generateEditableInputTableFromExcelData() {
      const table = $('#manual-input-table');
      table.empty();

      if (selectedCells.length === 0) {
        table.append(`
      <tr>
        <td colspan="4" class="text-center py-4 text-muted">
          未从Excel中识别到有效细胞数据
        </td>
      </tr>
    `);
        return;
      }

      // 添加表头
      table.append(`
  <table style="width: 300%; table-layout: fixed; border-collapse: collapse;">
    <thead>
      <tr>
        <thead>
      <tr>
        <th style="width: 15%">细胞类型</th>
        <th style="width: 20%">粘度值 (cP)</th>
        <th style="width: 10%">状态</th>
      </tr>
      </tr>
    </thead>
    <tbody id="manual-input-body"></tbody>
  `);

      const tbody = $('#manual-input-body');

      // 为每种细胞添加行（显示平均值）
      selectedCells.forEach(cell => {
        const cellId = cell.id;
        const cellInfo = cellData[cellId];

        const row = $(`
      <tr data-cell="${cellId}" style="width: 300%;">
        <td style="width: 15%">
          <span class="cell-icon">${cell.icon}</span>
          ${cell.name}
        </td>
        <td style="width: 20%">
          ${cellInfo.data[0].toFixed(2)} cP (平均值)
        </td>

        <td class="status-cell" style="width: 10%">
          <span class="status-badge status-safe">已计算</span>
        </td>
      </tr>
    `);

        // 添加查看详情事件
        row.find('.view-details').on('click', function() {
          showDetailsModal(cellInfo);
        });

        tbody.append(row);
      });
    }

// 新增详情弹窗函数
    function showDetailsModal(cell) {
      if (!cell || !cell.rawData || cell.rawData.length === 0) {
        alert('没有可用的详细数据');
        return;
      }

      const avg = cell.data[0];
      const count = cell.rawData.length;

      const modalHtml = `
    <div class="modal fade" id="detailsModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header bg-light">
            <h5 class="modal-title">
              <span class="cell-icon">${cell.icon}</span>
              ${cell.name} - 原始数据详情
            </h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="alert alert-info">
              基于 ${count} 个测量值计算得出平均值: <strong>${avg.toFixed(2)} cP</strong>
            </div>

            <h5>所有原始测量值</h5>
            <div class="table-responsive">
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>粘度值 (cP)</th>
                    <th>与平均值差值</th>
                  </tr>
                </thead>
                <tbody>
                  ${cell.rawData.map((v, i) => {
        const diff = v - avg;
        return `
                      <tr>
                        <td>${i+1}</td>
                        <td>${v.toFixed(2)}</td>
                        <td class="${diff > 0 ? 'text-danger' : 'text-success'}">
                          ${diff > 0 ? '+' : ''}${diff.toFixed(2)}
                        </td>
                      </tr>
                    `;
      }).join('')}
                </tbody>
              </table>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
          </div>
        </div>
      </div>
    </div>
  `;

      // 移除已有的模态框
      $('.modal').remove();

      // 添加并显示新模态框
      $('body').append(modalHtml);
      const modal = new bootstrap.Modal(document.getElementById('detailsModal'));
      modal.show();

      // 清理
      $('#detailsModal').on('hidden.bs.modal', function() {
        $(this).remove();
      });
    }

// 辅助函数
    function getStatusClass(value) {
      if(value >200||value<0) return 'status-warning';
      if (value > 100) return 'status-warning';
      if (value > 10) return 'status-safe';

      return 'status-info';
    }

    function getStatusText(value) {
      if(value >200||value<0) return '不符合';
      if (value > 100) return '偏高';
      if (value > 10) return '正常';

      return '偏低';
    }
// 新增函数：从Excel数据生成输入表格
    function generateManualInputTable() {
      const table = $('#manual-input-table');
      table.empty();

      if (selectedCells.length === 0) {
        table.append(`
      <tr>
        <td colspan="4" class="text-center py-4 text-muted">
          请先在上一步选择细胞类型
        </td>
      </tr>
    `);
        return;
      }

      // 添加表头
      table.append(`
    <thead>
      <tr>
        <th>细胞类型</th>
        <th>粘度值 (cP)</th>

        <th>状态</th>
      </tr>
    </thead>
    <tbody id="manual-input-body"></tbody>
  `);

      const tbody = $('#manual-input-body');

      selectedCells.forEach(cell => {
        // 为每种细胞添加初始行
        addNewViscosityRow(tbody, cell);
      });

      // 添加输入事件监听
      $('.viscosity-input').on('input', updateViscosityStatus);
      checkAllInputsComplete();
    }

    function addNewViscosityRow(container, cell, value = '') {
      const rowId = Date.now();
      const row = $(`
    <tr data-cell="${cell.id}" data-row="${rowId}">
      <td>
        <span class="cell-icon">${cell.icon}</span>
        ${cell.name}
      </td>
      <td>
        <div class="input-group">
          <input type="number" class="viscosity-input form-control"
                 value="${value}" min="0" max="200" step="0.1">
          <div class="input-group">
            <button class="btn btn-sm btn-outline-primary add-row" title="添加更多数据">
                   +
            </button>
            <button class="btn btn-sm btn-outline-danger remove-row" title="删除此行">
              ×
            </button>
          </div>
        </div>
      </td>
      <td class="status-cell">
        <span class="status-badge ${value ? 'status-safe' : 'status-empty'}">
          ${value ? '正常' : '未输入'}
        </span>
      </td>
    </tr>
  `);

      container.append(row);
      // 添加行操作按钮事件
      row.find('.add-row').on('click', function() {
        addNewViscosityRow(container, cell);
      });

      row.find('.remove-row').on('click', function() {
        if (container.find(`tr[data-cell="${cell.id}"]`).length > 1) {
          row.remove();
          checkAllInputsComplete();
        } else {
          alert('每种细胞至少需要保留一个数据输入行');
        }
      });

      row.find('.viscosity-input').on('input', updateViscosityStatus);
    }
    // 上一步按钮
    $('#back-btn').on('click', function() {
      $('#data-input').removeClass('active-step');
      $('#cell-selection').addClass('active-step');
    });

    // 生成手动输入表格

    function generateManualInputTable() {
      const table = $('#manual-input-table');
      table.empty();

      if (selectedCells.length === 0) {
        table.append(`
      <tr>
        <td colspan="4" class="text-center py-4 text-muted">
          请先在上一步选择细胞类型
        </td>
      </tr>
    `);
        return;
      }

      // 添加表头
      table.append(`
  <table style="width: 300%; table-layout: fixed; ">
    <thead>
      <tr>

        <th  style="width: 25%;">细胞类型</th>
        <th  style="padding-right: 40px">粘度值(cP)与操作</th>

        <th style="padding-right: 100px;">状态</th>
      </tr>
    </thead>
    <tbody id="manual-input-body"></tbody>
  </table>
`);
      const tbody = $('#manual-input-body');

      selectedCells.forEach(cell => {
        // 为每种细胞添加初始行
        addNewViscosityRow(tbody, cell);
      });

// 添加输入事件监听
      $('.viscosity-input').on('input', updateViscosityStatus);
      checkAllInputsComplete();
    }

// 添加新的粘度输入行
    function addNewViscosityRow(container, cell, value = '') {
      const rowId = Date.now(); // 使用时间戳作为唯一ID
      const row = $(`
    <tr data-cell="${cell.id}" data-row="${rowId}">
      <td>
        <span class="cell-icon">${cell.icon}</span>
        ${cell.name}
      </td>
      <td>
        <div class="input-group">
          <input type="number" class="viscosity-input form-control"
                 value="${value}" min="0" max="200" step="0.1">
          <div class="input-group-append">
            <button class="btn btn-sm btn-outline-primary add-row" title="添加更多数据">
                   +
            </button>
            <button class="btn btn-sm btn-outline-danger remove-row" title="删除此行">
              ×
            </button>
          </div>
        </div>
      </td>
      <td class="status-cell">
        <span class="status-badge ${value ? 'status-safe' : 'status-empty'}">
          ${value ? '正常' : '未输入'}
        </span>
      </td>
    </tr>
  `);
      container.append(row);

      // 添加行操作按钮事件
      row.find('.add-row').on('click', function() {
        addNewViscosityRow(container, cell);
      });

      row.find('.remove-row').on('click', function() {
        if (container.find(`tr[data-cell="${cell.id}"]`).length > 1) {
          row.remove();
          checkAllInputsComplete();
        } else {
          alert('每种细胞至少需要保留一个数据输入行');
        }
      });
      // 添加输入验证（手动输入）
      row.find('.viscosity-input').on('change', function() {
        const value = parseFloat($(this).val());
        if (!isNaN(value) && (value < 0 || value > 200)) {
          alert('粘度值必须在 0-200 cP 范围内！');
          $(this).val(''); // 清空无效输入
        }
        updateViscosityStatus.call(this);
      });
      // 添加输入事件监听
      row.find('.viscosity-input').on('change', function() {
        const value = parseFloat($(this).val());
        if (!isNaN(value) && (value < 0 || value > 200)) {
          alert('粘度值必须在0-200 cP范围内');
          $(this).val('');
        }
        updateViscosityStatus.call(this);
      });

      // 保留原有的输入事件
      row.find('.viscosity-input').on('input', updateViscosityStatus);
    }
    // 更新粘度输入状态
    function updateViscosityStatus() {
      const input = $(this);
      const value = parseFloat(input.val()) || 0;
      const row = input.closest('tr');
      const statusCell = row.find('.status-cell');

      let statusText = '正常';
      let statusClass = 'status-safe';

      if (isNaN(value) || input.val() === '') {
        statusText = '未输入';
        statusClass = 'status-empty';
      }
      else if (value > 200|| value <0) {
        statusText = '不符合';
        statusClass = 'status-info';
      }else if (value > 100) {
        statusText = '偏高';
        statusClass = 'status-warning';
      } else if (value < 10) {
        statusText = '偏低';
        statusClass = 'status-info';
      }



      statusCell.empty().append(`
    <span class="status-badge ${statusClass}">${statusText}</span>
  `);

      checkAllInputsComplete();
    }

    // 检查所有输入是否完成
    function checkAllInputsComplete() {
      // 如果是Excel导入模式
      if (window.dataSource === 'excel') {
        // 确保至少有一个细胞有数据
        const hasData = Object.keys(cellData).length > 0 &&
                Object.values(cellData).some(cell => cell.data.length > 0);
        $('#analyze-btn').prop('disabled', !hasData);
        return;
      }

      // 手动输入模式的验证
      let allValid = true;
      $('.viscosity-input').each(function() {
        const value = parseFloat($(this).val());
        if (isNaN(value)) {
          allValid = false;
          return false; // 退出循环
        }
      });

      $('#analyze-btn').prop('disabled', !allValid);
    }
    // Excel文件处理（数据输入页面）
    $('#excel-upload').on('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      $('#file-info').text(`已选择: ${file.name}`);

      // 解析Excel文件
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });

        // 获取第一个工作表
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

        // 显示预览
        showExcelPreview(jsonData);
      };
      reader.readAsArrayBuffer(file);
    });

    // Excel文件处理（细胞选择页面）
    $('#excel-upload-cells').on('change', function(e) {
      const file = e.target.files[0];
      if (!file) return;

      $('#file-info-cells').text(`已选择: ${file.name}`);

      // 解析Excel文件
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });

        // 获取第一个工作表
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

        // 显示预览
        showExcelPreviewCells(jsonData);
      };
      reader.readAsArrayBuffer(file);

      // 启用下一步按钮
      $('#next-btn').prop('disabled', false);
    });

    // 显示Excel预览（数据输入页面）
    function showExcelPreview(data) {
      const preview = $('#excel-preview');
      preview.empty();

      if (data.length === 0) {
        preview.append('<p class="text-muted p-3">Excel文件中没有数据</p>');
        return;
      }

      // 创建预览表格
      const table = $('<table class="table table-bordered table-sm mb-0"></table>');
      const thead = $('<thead class="table-light"></thead>');
      const tbody = $('<tbody></tbody>');

      // 添加表头
      const headerRow = $('<tr></tr>');
      data[0].forEach(cell => {
        headerRow.append($('<th></th>').text(cell));
      });
      thead.append(headerRow);

      // 添加数据行（最多显示5行）
      for (let i = 1; i < Math.min(6, data.length); i++) {
        const row = $('<tr></tr>');
        data[i].forEach(cell => {
          row.append($('<td></td>').text(cell));
        });
        tbody.append(row);
      }

      table.append(thead).append(tbody);
      preview.append(table);

      if (data.length > 6) {
        preview.append(`<p class="text-muted p-2">显示前5行，共${data.length-1}行数据</p>`);
      }

      $('#analyze-btn').prop('disabled', false);
    }

    // 显示Excel预览（细胞选择页面）

    function showExcelPreviewCells(data) {
      const preview = $('#excel-preview-cells');
      preview.empty();

      if (data.length === 0) {
        preview.append('<p class="text-muted p-3">Excel文件中没有数据</p>');
        return;
      }

      // 创建预览表格
      const table = $('<table class="table table-bordered table-sm mb-0"></table>');
      const thead = $('<thead class="table-light"></thead>');
      const tbody = $('<tbody></tbody>');

      // 添加表头
      const headerRow = $('<tr></tr>');
      headerRow.append($('<th>细胞类型</th>'));

      // 动态添加粘度列标题
      const maxColumns = Math.max(...data.map(row => row.length)) - 1;
      for (let i = 1; i <= maxColumns; i++) {
        headerRow.append($(`<th>粘度值 ${i}</th>`));
      }

      thead.append(headerRow);

      // 添加数据行（最多显示5行）
      for (let i = 1; i < Math.min(6, data.length); i++) {
        const row = $('<tr></tr>');
        // 细胞类型
        row.append($('<td></td>').text(data[i][0] || ''));

        // 粘度值
        for (let j = 1; j < data[i].length; j++) {
          row.append($('<td></td>').text(data[i][j]));
        }

        // 补齐空白单元格
        for (let j = data[i].length; j <= maxColumns; j++) {
          row.append($('<td></td>'));
        }

        tbody.append(row);
      }

      table.append(thead).append(tbody);
      preview.append(table);

      if (data.length > 6) {
        preview.append(`<p class="text-muted p-2">显示前5行，共${data.length-1}行数据</p>`);
      }
    }
    // 分析按钮

    $('#analyze-btn').on('click', function() {

      // 如果是Excel导入的数据
      if (window.dataSource === 'excel') {
        // 计算每种细胞的平均值
        Object.keys(cellData).forEach(cellId => {
          const cell = cellData[cellId];
          const sum = cell.data.reduce((a, b) => a + b, 0);
          const avg = sum / cell.data.length;

          // 更新为平均值
          cellData[cellId] = {
            ...cell,
            data: [avg],  // 保存平均值
            rawData: cell.data  // 保留原始数据
          };
        });

        showResults();
        $('#export-btn').prop('disabled', false);
        return;
      }

      // 处理手动输入的数据
      const inputData = processInputData();
      if (!inputData.isValid) {
        alert('请确保每种细胞至少输入一个有效的粘度值');
        return;
      }

      // 计算平均值
      Object.keys(inputData.data).forEach(cellId => {
        const cell = inputData.data[cellId];
        const sum = cell.data.reduce((a, b) => a + b, 0);
        const avg = sum / cell.data.length;

        cellData[cellId] = {
          name: cell.name,
          icon: cell.icon,
          data: [avg],
          rawData: cell.data
        };
      });

      showResults();
      $('#export-btn').prop('disabled', false);
    });


    // 处理Excel数据
    function processExcelData(data) {
      cellData = {};

      // 假设第一列是细胞类型，第二列是粘度值
      for (let i = 1; i < data.length; i++) {
        const row = data[i];
        if (!row || row.length < 2) continue;

        const cellType = row[0];
        const viscosity = parseFloat(row[1]);

        if (!cellType || isNaN(viscosity)) continue;

        // 查找匹配的细胞类型（更宽松的匹配）
        const matchedCell = selectedCells.find(c =>
                c.name === cellType ||
                c.id === cellType ||
                c.name.includes(cellType) ||
                cellType.includes(c.name));

        if (!matchedCell) {
          console.log(`未找到匹配的细胞类型: ${cellType}`);
          continue;
        }

        if (!cellData[matchedCell.id]) {
          cellData[matchedCell.id] = {
            name: matchedCell.name,
            icon: matchedCell.icon,
            data: []
          };
        }

        cellData[matchedCell.id].data.push(viscosity);
      }
      $('#analyze-btn').on('click', function() {
        // 处理两种数据来源：
        // 1. 手动输入的数据（通过input框）
        // 2. Excel导入的数据（存储在cellData中）

        const manualData = {};
        let hasManualData = false;

        // 收集手动输入的数据
        $('#manual-input-body tr[data-cell]').each(function() {
          const cellId = $(this).data('cell');
          const value = parseFloat($(this).find('.viscosity-input').val());

          if (!isNaN(value)) {
            if (!manualData[cellId]) {
              manualData[cellId] = {
                name: selectedCells.find(c => c.id === cellId).name,
                icon: selectedCells.find(c => c.id === cellId).icon,
                data: []
              };
            }
            manualData[cellId].data.push(value);
            hasManualData = true;
          }
        });

        // 确定使用哪个数据源
        const finalData = hasManualData ? manualData : cellData;

        if (Object.keys(finalData).length === 1) {
          alert('没有有效数据可供分析');
          return;
        }

        // 计算平均值
        Object.keys(finalData).forEach(cellId => {
          const cell = finalData[cellId];
          const sum = cell.data.reduce((a, b) => a + b, 0);
          const avg = sum / cell.data.length;

          cellData[cellId] = {
            name: cell.name,
            icon: cell.icon,
            data: [avg],
            rawData: cell.data
          };
        });

        // 显示结果
        showResults();
        $('#export-btn').prop('disabled', false);
      });

      // 调试信息
      console.log('处理后的cellData:', cellData);
    }

    // 显示结果
    function showResults() {

      $('#data-input').removeClass('active-step');
      $('#results').addClass('active-step');

      // 生成细胞选项卡
      const cellTabs = $('#cell-tabs');
      cellTabs.empty();

      Object.keys(cellData).forEach((cellId, index) => {
        const cell = cellData[cellId];
        const tab = $(`
            <div class="cell-tab ${index === 0 ? 'active' : ''}" data-cell="${cellId}">
              ${cell.name}
            </div>
          `);
        cellTabs.append(tab);
      });

      // 生成第一个细胞的结果内容
      if (Object.keys(cellData).length > 0) {
        generateResultContent(Object.keys(cellData)[0]);
      } else {
        $('#result-content').html(`
            <div class="text-center py-5">
              <div style="font-size: 3rem; color: #ffc107;">⚠️</div>
              <h4 class="mt-3">未找到有效数据</h4>
              <p>请检查输入的数据格式是否正确</p>
            </div>
          `);
        $('#export-btn').prop('disabled', true);
      }
      Object.keys(cellData).forEach(cellId => {
        if (!cellData[cellId].rawData) {
          cellData[cellId].rawData = cellData[cellId].data;
        }
      });
      // 添加选项卡点击事件
      $('.cell-tab').on('click', function() {
        $('.cell-tab').removeClass('active');
        $(this).addClass('active');
        generateResultContent($(this).data('cell'));
      });
    }

    // 生成结果内容

    // 修改后的 generateResultContent 函数
    function generateResultContent(cellType) {
      const resultContent = $('#result-content');
      const cell = cellData[cellType];
      const data = cell.data;
      const avg = data.reduce((a, b) => a + b, 0) / data.length;
      const avgViscosity = cell.data[0]; // 这里已经是平均值
      // 在数据库中查找匹配的细胞信息
      const dbCell = cellDatabase.find(c => c.细胞类型 === cellType);


      // 确定风险等级
      let riskLevel, riskColor;
     if (avg > 200||avg<10) {
        riskLevel = '不符合';
        riskColor = '#52c41a';
      }
      else if (avg > 150) {
        riskLevel = '高风险';
        riskColor = '#ff4d4f';
      } else if (avg > 100) {
        riskLevel = '轻度偏高';
        riskColor = '#faad14';
      } else if (avg > 10) {
        riskLevel = '正常';
        riskColor = '#52c41a';
      }
      else {
        riskLevel = '异常偏低';
        riskColor = '#FF0000';
      }

      // 生成HTML内容
      let htmlContent = `
    <div class="result-header">
      <div class="cell-info">
        <span class="result-cell-icon">${cell.icon}</span>
        <h2 class="result-cell-name">${cell.name}</h2>
      </div>
      <div class="viscosity-summary">
        <span class="avg-viscosity">${avg.toFixed(1)}</span> cP
        <div class="risk-tag" style="background: ${riskColor}">${riskLevel}</div>
      </div>
    </div>
  `;

      // 只有当粘度高于正常范围(>100)时才显示疾病风险和病理机制
      if (avg > 100 && dbCell) {
        htmlContent += `
      <div class="disease-section">
        <h5>相关疾病风险</h5>
        <div class="disease-cards">
          <div class="disease-card">
            <div class="disease-img">${dbCell.icon || '🦠'}</div>
            <div class="disease-content">
              <div class="disease-name">${dbCell.预测疾病类型}</div>
              <div class="disease-risk">
                <div class="risk-label">
                  <span>风险概率</span>
                  <span>${calculateRiskPercentage(avg)}%</span>
                </div>
                <div class="risk-bar">
                  <div class="risk-progress" style="width: ${calculateRiskPercentage(avg)}%; background: ${riskColor}"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="pathology-mechanism">
        <h5 class="pathology-title">病理机制分析</h5>
        <div class="pathology-content">${dbCell.病理机制}</div>
      </div>
    `;
      }

      // 总是显示建议
      const recommendations = generateRecommendations(avg, dbCell);
      const recommendationsHTML = recommendations.map(rec => `<li>${rec}</li>`).join('');

      htmlContent += `
    <div class="recommendations">
      <h5>建议</h5>
      <ul class="recommendation-list">
        ${recommendationsHTML}
      </ul>
    </div>
  `;

      resultContent.html(htmlContent);

      // 动画效果
      $('.risk-progress').each(function() {
        $(this).css('width', '0%').animate({
          width: $(this).attr('style').split('width:')[1].split('%;')[0] + '%'
        }, 800);
      });
    }
    // 计算风险百分比
    function calculateRiskPercentage(avgViscosity) {
      if (avgViscosity > 150) return Math.min(95, 70 + Math.floor((avgViscosity - 150) / 2));
      if (avgViscosity > 100) return Math.min(70, 40 + Math.floor((avgViscosity - 100) / 1.5));
      return Math.min(40, Math.floor(avgViscosity / 2.5));
    }

    // 生成建议
    function generateRecommendations(avg, dbCell) {
      const recs = [];

      if (dbCell) {
        if (avg > 150) {
          recs.push(`立即就医：针对${dbCell.预测疾病类型}进行专业检查`);
          recs.push('避免剧烈运动：减少氧化应激压力');
          recs.push('补充线粒体营养素：如辅酶Q10、α-硫辛酸、NAD+前体');
          recs.push('考虑抗氧化治疗：在医生指导下使用抗氧化剂');
        } else if (avg > 100) {
          recs.push(`3个月内复查：监测${dbCell.预测疾病类型}相关指标`);
          recs.push('补充抗氧化剂：如辅酶Q10、α-硫辛酸');
          recs.push('适度运动：每周3-5次中等强度运动');
          recs.push('改善饮食：增加抗氧化食物摄入');
        } else {
          recs.push('保持健康生活方式：规律作息，适度运动');
          recs.push('均衡饮食：多摄入抗氧化食物');
          recs.push('每年定期检查：监测线粒体健康状态');
          recs.push('管理压力：长期压力会影响线粒体功能');
        }
      } else {
        if (avg > 150) {
          recs.push('立即就医：建议进行专业线粒体功能检测');
          recs.push('避免剧烈运动：减少氧化应激压力');
          recs.push('补充线粒体营养素：如辅酶Q10、α-硫辛酸、NAD+前体');
          recs.push('考虑抗氧化治疗：在医生指导下使用抗氧化剂');
        } else if (avg > 100) {
          recs.push('3个月内复查：监测粘度变化趋势');
          recs.push('补充抗氧化剂：如辅酶Q10、α-硫辛酸');
          recs.push('适度运动：每周3-5次中等强度运动');
          recs.push('改善饮食：增加抗氧化食物摄入');
        } else {
          recs.push('保持健康生活方式：规律作息，适度运动');
          recs.push('均衡饮食：多摄入抗氧化食物');
          recs.push('每年定期检查：监测线粒体健康状态');
          recs.push('管理压力：长期压力会影响线粒体功能');
        }
      }

      return recs;
    }

    // 重新开始
    $('#restart-btn').on('click', function() {
      selectedCells = [];
      cellData = {};
      $('#cell-select').val(null).trigger('change');
      $('#results').removeClass('active-step');
      $('#cell-selection').addClass('active-step');
      $('#next-btn').prop('disabled', true);
      $('#export-btn').prop('disabled', true);
      $('#file-info-cells').text('');
      $('#excel-preview-cells').empty();
      $('#file-info').text('');
      $('#excel-preview').empty();

      // 重置到手动选择标签
      $('.tab-btn', '#cell-selection').removeClass('active');
      $('.tab-btn[data-tab="manual"]', '#cell-selection').addClass('active');

      $('.tab-content', '#cell-selection').removeClass('active');
      $('#manual-tab', '#cell-selection').addClass('active');
    });

    // 导出结果
    $('#export-btn').on('click', function() {
      exportResults();
    });

    // 导出结果功能
    function exportResults() {
      // 创建工作簿
      const wb = XLSX.utils.book_new();

      // 为每个细胞类型创建工作表
      Object.keys(cellData).forEach(cellId => {
        const cell = cellData[cellId];
        const data = cell.data;
        const avg = data.reduce((a, b) => a + b, 0) / data.length;

        // 在数据库中查找匹配的细胞信息
        const dbCell = cellDatabase.find(c => c.细胞类型 === cellId);

        // 准备数据
        const sheetData = [
          ['细胞类型', cell.name],
          ['平均粘度', `${avg.toFixed(1)} cP`],
          ['样本数量', data.length],
          ['最低粘度', `${Math.min(...data).toFixed(1)} cP`],
          ['最高粘度', `${Math.max(...data).toFixed(1)} cP`],
          [],
          ['相关疾病风险']
        ];

        if (dbCell) {
          sheetData.push(
                  ['预测疾病类型', dbCell.预测疾病类型],
                  ['风险等级', calculateRiskPercentage(avg) + '%'],
                  [],
                  ['病理机制'],
                  ...dbCell.病理机制.split('\n').map(line => [line])
          );
        }

        sheetData.push(
                [],
                ['建议'],
                ...generateRecommendations(avg, dbCell).map(r => [r])
        );

        // 创建工作表
        const ws = XLSX.utils.aoa_to_sheet(sheetData);

        // 添加到工作簿
        XLSX.utils.book_append_sheet(wb, ws, cell.name.substring(0, 31)); // 工作表名称最多31字符
      });

      // 导出Excel文件
      const fileName = `线粒体粘度分析_${new Date().toISOString().slice(0, 10)}.xlsx`;
      XLSX.writeFile(wb, fileName);
    }
  });
  // 导航页按钮事件
  $('#manual-start').on('click', function() {
    $('#welcome-page').removeClass('active-step');
    $('#cell-selection').addClass('active-step');
    dataSource = 'manual';

    // 默认选择手动选择标签
    $('.tab-btn', '#cell-selection').removeClass('active');
    $('.tab-btn[data-tab="manual"]', '#cell-selection').addClass('active');

    $('.tab-content', '#cell-selection').removeClass('active');
    $('#manual-tab', '#cell-selection').addClass('active');
  });

  $('#excel-start').on('click', function() {
    $('#welcome-page').removeClass('active-step');
    $('#cell-selection').addClass('active-step');
    dataSource = 'excel';

    // 默认选择Excel导入标签
    $('.tab-btn', '#cell-selection').removeClass('active');
    $('.tab-btn[data-tab="excel"]', '#cell-selection').addClass('active');

    $('.tab-content', '#cell-selection').removeClass('active');
    $('#excel-tab', '#cell-selection').addClass('active');
  });

  // 返回导航页按钮
  $('#back-to-welcome').on('click', function() {
    $('#cell-selection').removeClass('active-step');
    $('#welcome-page').addClass('active-step');
  });
</script>
</body>
</html>
